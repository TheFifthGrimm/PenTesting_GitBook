# Network Security

## <mark style="color:blue;">Passive Reconnaissance</mark>

In passive reconnaissance, you rely on publicly available knowledge. It is the knowledge that you can access from publicly available resources without directly engaging with the target. Think of it like you are looking at target territory from afar without stepping foot on that territory.

Three main tools will be covered:

<mark style="color:yellow;">whois</mark> to query WHOIS servers&#x20;

<mark style="color:yellow;">nslookup</mark> to query DNS servers&#x20;

<mark style="color:yellow;">dig</mark> to query DNS servers

We use whois to query WHOIS records, while we use nslookup and dig to query DNS database records. These are all publicly available records and hence do not alert the target.

Two online tools will also be covered

<mark style="color:yellow;">DNSDumpter</mark>

<mark style="color:yellow;">Shodan.io</mark>

These two online services allow us to collect information about our target without directly connecting to it.



#### <mark style="color:red;">Whois</mark>

A request and response protocol that follows the RFC 3912 specification. A WHOIS server listens on TCP port 43 for incoming requests. The domain registrar is responsible for maintaining the WHOIS records for the domain names it is leasing. The WHOIS server replies with various information related to the domain requested.&#x20;

To use the command use the syntax below where DOMAIN\_NAME is the domain about which you are trying to get more information.&#x20;

```
whois DOMAIN_NAME
```



#### <mark style="color:red;">Nslookup</mark>

Use nslookup to find the IP address of a domain name.

```
nslookup DOMAIN_NAME
```

Or, more generally, you can use <mark style="color:yellow;">`nslookup OPTIONS DOMAIN_NAME SERVER`</mark>. These three main parameters are:

<mark style="color:yellow;">OPTIONS</mark> contains the query type as shown in the table below. For instance, you can use A for IPv4 addresses and AAAA for IPv6 addresses.

<mark style="color:yellow;">DOMAIN\_NAME</mark> is the domain name you are looking up.&#x20;

<mark style="color:yellow;">SERVER</mark> is the DNS server that you want to query. You can choose any local or public DNS server to query. Cloudflare offers 1.1.1.1 and 1.0.0.1, Google offers 8.8.8.8 and 8.8.4.4, and Quad9 offers 9.9.9.9 and 149.112.112.112. There are many more public DNS servers that you can choose from if you want alternatives to your ISP’s DNS servers.

| Query Type | Results            |
| ---------- | ------------------ |
| A          | IPv4 Addresses     |
| AA         | IPv6 Addresses     |
| CNAME      | Canonical Name     |
| MX         | Mail Servers       |
| SOA        | Start of Authority |
| TXT        | TXT Records        |



<mark style="color:red;">**Dig**</mark>

For more advanced DNS queries and additional functionality, you can use dig, the acronym for <mark style="color:yellow;">“Domain Information Groper”</mark>. Let’s use dig to look up the MX records and compare them to nslookup. We can use dig `DOMAIN_NAME`, but to specify the record type, we would use dig `DOMAIN_NAME TYPE`. Optionally, we can select the server we want to query using `dig @SERVER DOMAIN_NAME TYPE`.

<mark style="color:yellow;">SERVER</mark> is the DNS server that you want to query.&#x20;

<mark style="color:yellow;">DOMAIN\_NAME</mark> is the domain name you are looking up.&#x20;

<mark style="color:yellow;">TYPE</mark> contains the DNS record type, as shown in the table provided earlier.



<mark style="color:red;">**DNSDumpster**</mark>

DNS lookup tools, such as nslookup and dig, cannot find subdomains on their own. The domain you are inspecting might include a different subdomain that can reveal much information about the target.



<mark style="color:red;">**Shodan.io**</mark>

When you are tasked to run a penetration test against specific targets, as part of the passive reconnaissance phase, a service like Shodan.io can be helpful to learn various pieces of information about the client’s network, without actively connecting to it.





<mark style="color:red;">SUMMARY</mark>

<figure><img src=".gitbook/assets/image (1).png" alt=""><figcaption></figcaption></figure>

## <mark style="color:blue;">Active Reconnaissance</mark>

Active reconnaissance cannot be achieved so discreetly. It requires direct engagement with the target. Think of it like you check the locks on the doors and windows, among other potential entry points.

Examples of active reconnaissance activities include:

* Connecting to one of the company servers such as HTTP, FTP, and SMTP.
* Calling the company in an attempt to get information (social engineering).
* Entering company premises pretending to be a repairman.

<mark style="color:yellow;">Essential tools</mark> for active reconnaissance include:

* <mark style="color:yellow;">ping</mark> - ping is a command that sends an ICMP Echo packet to a remote system. If the remote system is online, and the ping packet was correctly routed and not blocked by any firewall, the remote system should send back an ICMP Echo Reply. Similarly, the ping reply should reach the first system if appropriately routed and not blocked by any firewall.



* <mark style="color:yellow;">traceroute</mark> - the traceroute command traces the route taken by the packets from your system to another host. The purpose of a traceroute is to find the IP addresses of the routers or hops that a packet traverses as it goes from your system to a target host. This command also reveals the number of routers between the two systems. It is helpful as it indicates the number of hops (routers) between your system and the target host. However, note that the route taken by the packets might change as many routers use dynamic routing protocols that adapt to network changes.



* <mark style="color:yellow;">telnet</mark> - The default port used by telnet is 23. From a security perspective, telnet sends all the data, including usernames and passwords, in cleartext. Sending in cleartext makes it easy for anyone, who has access to the communication channel, to steal the login credentials. The secure alternative is SSH (Secure SHell) protocol. **** However, the telnet client, with its simplicity, can be used for other purposes. Knowing that telnet client relies on the TCP protocol, you can use Telnet to connect to any service and grab its banner. Using `telnet IP_ADDRESS PORT`, you can connect to any service running on TCP and even exchange a few messages unless it uses encryption.

Let’s say we want to discover more information about a web server, listening on port 80. We connect to the server at port 80, and then we communicate using the HTTP protocol. You don’t need to dive into the HTTP protocol; you just need to issue GET / HTTP/1.1. To specify something other than the default index page, you can issue GET /page.html HTTP/1.1, which will request page.html. We also specified to the remote web server that we want to use HTTP version 1.1 for communication. To get a valid response, instead of an error, you need to input some value for the host host: example and hit enter twice. Executing these steps will provide the requested index page.

<figure><img src=".gitbook/assets/image.png" alt=""><figcaption><p>The VM IP was 10.10.53.170 for this example, change accordingly</p></figcaption></figure>

<mark style="color:yellow;">Netcat</mark>

Netcat supports both TCP and UDP protocols. It can function as a client that connects to a listening port; alternatively, it can act as a server that listens on a port of your choice. Hence, it is a convenient tool that you can use as a simple client or server over TCP or UDP. **** Below is an example of how you might use netcat to target a specific ip and port.

<figure><img src=".gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>



On the transport level, the browser connects to:

* <mark style="color:yellow;">TCP port 80 by default when the website is accessed over HTTP</mark>&#x20;
* <mark style="color:yellow;">TCP port 443 by default when the website is accessed over HTTPS</mark>

The table below summarizes the key commands outlined in the active reconnaissance module

<figure><img src=".gitbook/assets/image (10).png" alt=""><figcaption></figcaption></figure>

## <mark style="color:blue;">Nmap Live Host Discovery</mark>

When we want to target a network, we want to find an efficient tool to help us handle repetitive tasks and answer the following questions:

* Which systems are up?
* &#x20;What services are running on these systems?

Nmap has the ability to do answer both of these questions. The first will be discussed here, the second further below.&#x20;

<mark style="color:red;">**Subnets**</mark>

As part of active reconnaissance, we want to discover more information about a group of hosts or about a subnet. If you are connected to the same subnet, you would expect your scanner to rely on ARP (Address Resolution Protocol) queries to discover live hosts. An ARP query aims to get the hardware address (MAC address) so that communication over the link-layer becomes possible; however, we can use this to infer that the host is online.

If you are in Network A, you can use ARP only to discover the devices within that subnet (xxx.xxx.xxx.0/24). Suppose you are connected to a subnet different from the subnet of the target system(s). In that case, all packets generated by your scanner will be routed via the default gateway (router) to reach the systems on another subnet; however, the ARP queries won’t be routed and hence cannot cross the subnet router. ARP is a link-layer protocol, and ARP packets are bound to their subnet.

<mark style="color:red;">**Enumerating Targets**</mark>

<figure><img src=".gitbook/assets/image (6).png" alt=""><figcaption></figcaption></figure>

## <mark style="color:blue;">Nmap Basic Port Scans</mark>

<mark style="color:blue;"></mark>

<mark style="color:blue;"></mark>

<mark style="color:blue;"></mark>

## <mark style="color:blue;">Nmap Advanced Port Scans</mark>







## <mark style="color:blue;">Nmap Post Port Scans</mark>







## <mark style="color:blue;">Protocols and Servers</mark>

<mark style="color:blue;"></mark>





## <mark style="color:blue;">Protocols and Servers 2</mark>

<mark style="color:blue;"></mark>

<mark style="color:blue;"></mark>

## <mark style="color:blue;">Net Sec Challenge</mark>





























